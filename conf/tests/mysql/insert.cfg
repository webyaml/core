# filename: conf/tests/mysql/insert.cfg
# path: /tests/mysql/selct

############################################################
##
## Tests : MySQL : Insert
##
## Insert records into MySQL
##
############################################################


noindent:
preprocess:
	type: lib.processors.mysql.Insert
	sql: |
		INSERT INTO test
		(`one`, `two`, `three`)
			VALUES
		("un", "deux", "trois")
	conf:
		host: localhost
		user: webyaml
		db: webyaml
		passwd: webyaml
	cache_id: insert_id

	'true':
		type: lib.processors.mysql.Select
		sql: "SELECT `one`, `two`, `three` FROM test WHERE id = {{cache:insert_id}}"
		conf:
			host: localhost
			user: webyaml
			db: webyaml
			passwd: webyaml
		reader: list
		result:
			store: mysql_select
		'true':
			type: lib.processors.logic.Evaluate
			expression: '"{{string(mysql_select).md5()}}" == "d3d9470a4852188eae00cc6c18eeceb4"'
			'true':
				content:
					noindent:
					value: 'pass'
			
			'false':
				content:
					noindent:
					value: 'fail'
